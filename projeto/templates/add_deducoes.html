{% extends 'base.html' %}

{% block conteudo %}

    <form method="POST">
        <!-- Selecionar uma dedução já existente -->
        <label for="deducao">Escolher dedução existente:</label>
        <select name="deducao" id="deducao" onchange="atualizarCampos()">
            <option value="">Selecione uma dedução</option>
            {% for deducao in deducoes_existentes %}
                <option value="{{ deducao.id_deducao }}" data-desc="{{ deducao.desc_deducao }}" data-valor="{{ deducao.valor_deducao }}">
                    {{ deducao.desc_deducao }}
                </option>
            {% endfor %}
        </select>
        
        <br><br>
        
        <!-- Caso o usuário queira adicionar um novo provento -->
        <label for="desc_deducao">Descrição do Novo Provento:</label>
        <input type="text" name="desc_deducao" id="descricao" required>
        
        <label for="valor_deducao">Valor do Novo Provento:</label>
        <input type="number" step="0.01" name="valor_deducao" id="valor" required>
        
        <br><br>
        
        <button type="submit">Adicionar Provento</button>
    </form>


    <!-- Usando JS para se caso o usuário selecionar alguma dedução, as informações já aparecerem nos campos -->
    <script>
        function atualizarCampos() {
            var select = document.getElementById('deducao');
            var descricaoField = document.getElementById('descricao');
            var valorField = document.getElementById('valor');
            
            var selectedOption = select.options[select.selectedIndex];
            
            // Verifica se uma opção foi selecionada
            if (selectedOption.value) {
                // Preenche os campos de descrição e valor com os dados da opção selecionada
                descricaoField.value = selectedOption.getAttribute('data-desc');
                valorField.value = selectedOption.getAttribute('data-valor');
            } else {
                // Limpa os campos caso nenhuma opção seja selecionada
                descricaoField.value = '';
                valorField.value = '';
            }
        }
    </script>

{% endblock %}